<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
</head>
<body>
    <h2>회원가입</h2>
    <form id="signupForm">
        <label for="email">이메일</label>
        <input type="email" id="email" name="email" required>

        <label for="password">비밀번호</label>
        <input type="password" id="password" name="password" required>

        <label for="name">이름</label>
        <input type="text" id="name" name="name" required>

        <label for="phone">전화번호</label>
        <input type="tel" id="phone" name="phone" required pattern="[0-9]{10,11}" placeholder="숫자만 입력">

        <label for="gender">성별</label>
        <select id="gender" name="gender" required>
            <option value="" selected>선택하세요</option>
            <option value="MALE">남성</option>
            <option value="FEMALE">여성</option>
        </select>

        <label for="birth_date">생년월일</label>
        <input type="date" id="birth_date" name="birth_date" required>

        <button type="submit">가입하기</button>
    </form>

    <script>
        document.getElementById("signupForm").addEventListener("submit", async function(e) {
            e.preventDefault();

            const formData = {
                email: document.getElementById("email").value,
                password: document.getElementById("password").value,
                name: document.getElementById("name").value,
                phone: document.getElementById("phone").value,
                gender: document.getElementById("gender").value,
                birthDate: document.getElementById("birth_date").value
            };

            try {
                const response = await fetch("/api/signup", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert("회원가입이 완료되었습니다.");
                    window.location.href = "/login";
                } else {
                    const errorText = await response.text();
                    alert("회원가입 실패: " + errorText);
                }
            } catch (error) {
                alert("오류 발생: " + error.message);
            }
        });
    </script>
</body>
</html>